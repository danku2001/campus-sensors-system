{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DAN\\\\Desktop\\\\fullProject\\\\frontend-react\\\\frontend-react\\\\src\\\\components\\\\ShadingPanel.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { listAreasWithShading, attachShading, setShading } from \"../api/shading\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ShadingPanel({\n  onKpiUpdate\n}) {\n  _s();\n  const [rows, setRows] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [busy, setBusy] = useState(null);\n  const load = async () => {\n    setLoading(true);\n    try {\n      const data = await listAreasWithShading();\n      const list = Array.isArray(data) ? data : [];\n      setRows(list);\n      const k = {\n        areas: list.length,\n        open: list.filter(x => x.status === \"open\").length,\n        user: list.filter(x => x.added_by_user).length\n      };\n      onKpiUpdate && onKpiUpdate(k);\n    } catch (e) {\n      console.error(e);\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    load();\n  }, []);\n  const ensureAttach = async area_id => {\n    try {\n      await attachShading(area_id);\n    } catch {}\n  };\n  const toggle = async (area_id, currStatus) => {\n    try {\n      setBusy(area_id);\n      await ensureAttach(area_id);\n      const next = currStatus === \"open\" ? \"closed\" : \"open\";\n      await setShading(area_id, next, true);\n      await load();\n    } finally {\n      setBusy(null);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    className: \"panel\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      style: {\n        marginTop: 0,\n        marginBottom: 10\n      },\n      children: \"\\u05DE\\u05E2\\u05E8\\u05DB\\u05D5\\u05EA \\u05D4\\u05E6\\u05DC\\u05DC\\u05D4 \\u05DC\\u05E4\\u05D9 \\u05D0\\u05D6\\u05D5\\u05E8\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        opacity: .8\n      },\n      children: \"\\u05D8\\u05D5\\u05E2\\u05DF \\u05D4\\u05E6\\u05DC\\u05DC\\u05D4...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"head\",\n        children: \"\\u05D0\\u05D6\\u05D5\\u05E8\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"head\",\n        children: \"\\u05E1\\u05D8\\u05D8\\u05D5\\u05E1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"head\",\n        children: \"\\u05D0\\u05D9\\u05E0\\u05D3\\u05D9\\u05E7\\u05D8\\u05D5\\u05E8\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"head\",\n        children: \"\\u05E4\\u05E2\\u05D5\\u05DC\\u05D4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 11\n      }, this), rows.map(r => {\n        const open = r.status === \"open\";\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cell\",\n            children: r.area_name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 62,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cell\",\n            children: open ? \"פתוח\" : \"סגור\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 63,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cell\",\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"badge\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"dot \" + (open ? \"success\" : \"muted\")\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 66,\n                columnNumber: 21\n              }, this), r.added_by_user ? \"נוסף ע\\\"י משתמש\" : \"מערכתי\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 65,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cell\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn\",\n              onClick: () => toggle(r.area_id, r.status),\n              disabled: busy === r.area_id,\n              children: busy === r.area_id ? \"מבצע...\" : open ? \"סגור\" : \"פתח\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 71,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 17\n          }, this)]\n        }, r.area_id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 15\n        }, this);\n      })]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 5\n  }, this);\n}\n_s(ShadingPanel, \"w7pXTKCdFMhz+qw1TIVxzy4OHi0=\");\n_c = ShadingPanel;\nvar _c;\n$RefreshReg$(_c, \"ShadingPanel\");","map":{"version":3,"names":["React","useEffect","useState","listAreasWithShading","attachShading","setShading","jsxDEV","_jsxDEV","ShadingPanel","onKpiUpdate","_s","rows","setRows","loading","setLoading","busy","setBusy","load","data","list","Array","isArray","k","areas","length","open","filter","x","status","user","added_by_user","e","console","error","ensureAttach","area_id","toggle","currStatus","next","className","children","style","marginTop","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","opacity","map","r","area_name","onClick","disabled","_c","$RefreshReg$"],"sources":["C:/Users/DAN/Desktop/fullProject/frontend-react/frontend-react/src/components/ShadingPanel.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { listAreasWithShading, attachShading, setShading } from \"../api/shading\";\n\nexport default function ShadingPanel({ onKpiUpdate }) {\n  const [rows, setRows] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [busy, setBusy] = useState(null);\n\n  const load = async () => {\n    setLoading(true);\n    try {\n      const data = await listAreasWithShading();\n      const list = Array.isArray(data) ? data : [];\n      setRows(list);\n      const k = {\n        areas: list.length,\n        open: list.filter(x => x.status === \"open\").length,\n        user: list.filter(x => x.added_by_user).length\n      };\n      onKpiUpdate && onKpiUpdate(k);\n    } catch (e) {\n      console.error(e);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => { load(); }, []);\n\n  const ensureAttach = async (area_id) => {\n    try { await attachShading(area_id); } catch {}\n  };\n\n  const toggle = async (area_id, currStatus) => {\n    try {\n      setBusy(area_id);\n      await ensureAttach(area_id);\n      const next = currStatus === \"open\" ? \"closed\" : \"open\";\n      await setShading(area_id, next, true);\n      await load();\n    } finally {\n      setBusy(null);\n    }\n  };\n\n  return (\n    <section className=\"panel\">\n      <h3 style={{marginTop:0, marginBottom:10}}>מערכות הצללה לפי אזור</h3>\n      {loading ? (\n        <div style={{opacity:.8}}>טוען הצללה...</div>\n      ) : (\n        <div className=\"grid\">\n          <div className=\"head\">אזור</div>\n          <div className=\"head\">סטטוס</div>\n          <div className=\"head\">אינדיקטור</div>\n          <div className=\"head\">פעולה</div>\n\n          {rows.map(r => {\n            const open = r.status === \"open\";\n            return (\n              <div className=\"row\" key={r.area_id}>\n                <div className=\"cell\">{r.area_name}</div>\n                <div className=\"cell\">{open ? \"פתוח\" : \"סגור\"}</div>\n                <div className=\"cell\">\n                  <span className=\"badge\">\n                    <span className={\"dot \" + (open ? \"success\" : \"muted\")} />\n                    {r.added_by_user ? \"נוסף ע\\\"י משתמש\" : \"מערכתי\"}\n                  </span>\n                </div>\n                <div className=\"cell\">\n                  <button className=\"btn\" onClick={() => toggle(r.area_id, r.status)} disabled={busy === r.area_id}>\n                    {busy === r.area_id ? \"מבצע...\" : (open ? \"סגור\" : \"פתח\")}\n                  </button>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      )}\n    </section>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}